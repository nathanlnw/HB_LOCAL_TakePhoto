#include  <string.h>
#include "Menu_Include.h"
#include "Lcd.h"

static unsigned char vech_num[16]={"车牌号:        "};
static unsigned char vech_type[25]={"车辆类型:            "};
static unsigned char  vech_ID[19]={"入网ID:            "}; 
static unsigned char  vech_VIN[20]={"VIN                 "}; 
static unsigned char  vech_login[20]={"                    "}; //vech_login
static unsigned char updown_flag=0;

//驾驶员代码
void Display_driver(u8 drivercar)
{
    u8 color_disp[4];
switch(drivercar)
	{
	case 1:
	
		memcpy(vech_num+7,JT808Conf_struct.Vechicle_Info.Vech_Num,8); 
		//rt_kprintf("\r\n1.vech_num=%s,JT808Conf_struct.Vechicle_Info.Vech_Num=%s,Menu_Car_license=%s",vech_num,JT808Conf_struct.Vechicle_Info.Vech_Num,Menu_Car_license);
		
            //车辆颜色
               memset(color_disp,0,sizeof(color_disp));
               switch(JT808Conf_struct.Vechicle_Info.Dev_Color)
               	{
                case 1: memcpy(color_disp,"蓝色",4);break;
                case 2:memcpy(color_disp,"黄色",4);break;
			    case 3:memcpy(color_disp,"黑色",4);break;
			    case 4:memcpy(color_disp,"白色",4);break;
			    case 9:memcpy(color_disp,"其他",4);break;
			    default:memcpy(color_disp,"蓝色",4);break;	
               	}
        lcd_fill(0);
        lcd_text12(10,3,(char *)vech_num,15,LCD_MODE_SET);	   
        lcd_text12(10,19,"车牌颜色:",9,LCD_MODE_SET);
        lcd_text12(64,19,(char *)color_disp,4,LCD_MODE_SET); 
        lcd_update_all();
    	//rt_kprintf("\r\n2.vech_num=%s,JT808Conf_struct.Vechicle_Info.Vech_Num=%s,Menu_Car_license=%s",vech_num,JT808Conf_struct.Vechicle_Info.Vech_Num,Menu_Car_license);
		break;

	case 2://车辆ID Vechicle_Info.DevicePhone
		lcd_fill(0);
              memcpy(vech_type+9,JT808Conf_struct.Vechicle_Info.Vech_Type,6);
		lcd_text12(0,3,(char *)vech_type,19,LCD_MODE_SET);		
		//读取设备速度取得是GPS速度还是速度线速度
		/*DF_ReadFlash(DF_Speed_GetType_Page,0,(u8*)&Speed_GetType,1);
		if(Speed_GetType==0)*/
			lcd_text12(0,19,"设备速度:GPS速度",16,LCD_MODE_SET);
		/*else if(Speed_GetType==1)
			lcd_text12(0,5,"设备速度:传感器速度",19,LCD_MODE_SET);*/
		lcd_update_all();
		break;
	case 3:  //  车辆ID
		lcd_fill(0);
		memcpy(vech_ID+7,SIM_CardID_JT808,12); //入网ID   ,输入的手机号码
		lcd_text12(0,3,(char *)vech_ID,19,LCD_MODE_SET);
		memcpy(vech_VIN+3,JT808Conf_struct.Vechicle_Info.Vech_VIN,17); //车辆VIN
		lcd_text12(0,19,(char *)vech_VIN,20,LCD_MODE_SET);
		lcd_update_all();   
		 break;
	 case 4:  //  车辆ID
 		memcpy(vech_login+7,JT808Conf_struct.ConfirmCode,strlen(JT808Conf_struct.ConfirmCode)); //车辆VIN
		lcd_fill(0);
		lcd_text12(0,3,"鉴权码",6,LCD_MODE_SET);
		lcd_text12(0,18,(char *)vech_login,strlen(JT808Conf_struct.ConfirmCode)+7,LCD_MODE_SET);
		lcd_update_all();   
		 break;
	default:
		break;
	}

}

static void msg( void *p)
{
}
static void show(void)
{
	lcd_fill(0);
	lcd_text12(24, 3,"车辆信息查看",12,LCD_MODE_SET);
	lcd_text12(24,19,"查看请按选择",12,LCD_MODE_SET);
	lcd_update_all();

}


static void keypress(unsigned int key)
{
	switch(KeyValue)
		{
		case KeyValueMenu:
			pMenuItem=&Menu_2_InforCheck;
			pMenuItem->show();
			CounterBack=0;

			updown_flag=0;
			break;
		case KeyValueOk:
			updown_flag=1;
			Display_driver(1);
			break;
		case KeyValueUP:
                    if(updown_flag==1)
				updown_flag=4;
			else
				updown_flag--;
			Display_driver(updown_flag);
			break;
		case KeyValueDown:
                   if(updown_flag==4)
				updown_flag=1;
		      else
				updown_flag++;
			Display_driver(updown_flag);
			break;
		}
	KeyValue=0;
}


static void timetick(unsigned int systick)
{
    Cent_To_Disp();
	CounterBack++;
	if(CounterBack!=MaxBankIdleTime)
		return;
	CounterBack=0;
	pMenuItem=&Menu_1_Idle;
	pMenuItem->show();
}


ALIGN(RT_ALIGN_SIZE)
MENUITEM	Menu_2_4_CarInfor=
{
	"车辆信息查看",
	12,
	&show,
	&keypress,
	&timetick,
	&msg,
	(void*)0
};


